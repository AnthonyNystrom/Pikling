<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp"><head><title>cvCalcOpticalFlowPyrLK Method (prev, curr, prevPyr, currPyr, prevFeatures, currFeatures, count, winSize, level, status, trackError, criteria, flags)</title><link rel="stylesheet" type="text/css" href="../styles/presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/script_prototype.js"> </script><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/StyleUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/ElementCollection.js"> </script><script type="text/javascript" src="../scripts/MemberFilter.js"> </script><script type="text/javascript" src="../scripts/CollapsibleSection.js"> </script><script type="text/javascript" src="../scripts/LanguageFilter.js"> </script><script type="text/javascript" src="../scripts/CookieDataStore.js"> </script><meta name="file" content="6a852f44-91f2-740d-d621-b724f94e278c" /><xml xmlns:msxsl="urn:schemas-microsoft-com:xslt"><MSHelp:Attr Name="AssetID" Value="M:Emgu.CV.CvInvoke.cvCalcOpticalFlowPyrLK(System.IntPtr,System.IntPtr,System.IntPtr,System.IntPtr,System.Single[0:,0:],System.Single[0:,0:],System.Int32,System.Drawing.Size,System.Int32,System.Byte[],System.Single[],Emgu.CV.Structure.MCvTermCriteria,Emgu.CV.CvEnum.LKFLOW_TYPE)" /><MSHelp:Keyword Index="A" Term="M:Emgu.CV.CvInvoke.cvCalcOpticalFlowPyrLK(System.IntPtr,System.IntPtr,System.IntPtr,System.IntPtr,System.Single[0:,0:],System.Single[0:,0:],System.Int32,System.Drawing.Size,System.Int32,System.Byte[],System.Single[],Emgu.CV.Structure.MCvTermCriteria,Emgu.CV.CvEnum.LKFLOW_TYPE)" /><MSHelp:Keyword Index="A" Term="frlrfEmguCVCvInvokeClasscvCalcOpticalFlowPyrLKTopic" /><MSHelp:Keyword Index="K" Term="cvCalcOpticalFlowPyrLK method" /><MSHelp:Keyword Index="K" Term="CvInvoke.cvCalcOpticalFlowPyrLK method" /><MSHelp:Keyword Index="F" Term="cvCalcOpticalFlowPyrLK" /><MSHelp:Keyword Index="F" Term="CvInvoke.cvCalcOpticalFlowPyrLK" /><MSHelp:Keyword Index="F" Term="Emgu.CV.CvInvoke.cvCalcOpticalFlowPyrLK" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="Emgu.CV.dll" /><MSHelp:Attr Name="APIName" Value="Emgu.CV..cvCalcOpticalFlowPyrLK" /><MSHelp:Attr Name="Locale" Value="en-us" /></xml></head><body><div id="control"><span class="productTitle">Emgu CV Library Documentation</span><br /><span class="topicTitle">cvCalcOpticalFlowPyrLK Method (prev, curr, prevPyr, currPyr, prevFeatures, currFeatures, count, winSize, level, status, trackError, criteria, flags)</span><br /><div id="toolbar"><span id="chickenFeet"><a href="d4648875-d41a-783b-d5f4-638df39ee413.htm">Namespaces</a> ► <a href="b72c032d-59ae-c36f-5e00-12f8d621dfb8.htm">Emgu.CV</a> ► <a href="bb544594-4bf7-5a11-594c-f143b226f1da.htm">CvInvoke</a> ► <span class="selflink">cvCalcOpticalFlowPyrLK(IntPtr, IntPtr, IntPtr, IntPtr, <span class="languageSpecificText"><span class="cpp">array&lt;</span></span>Single<span class="languageSpecificText"><span class="cpp">,2&gt;</span><span class="cs">[,]</span><span class="vb">(,)</span><span class="nu">[,]</span></span>, <span class="languageSpecificText"><span class="cpp">array&lt;</span></span>Single<span class="languageSpecificText"><span class="cpp">,2&gt;</span><span class="cs">[,]</span><span class="vb">(,)</span><span class="nu">[,]</span></span>, Int32, Size, Int32, <span class="languageSpecificText"><span class="cpp">array&lt;</span></span>Byte<span class="languageSpecificText"><span class="cpp">&gt;</span><span class="cs">[]</span><span class="vb">()</span><span class="nu">[]</span></span>, <span class="languageSpecificText"><span class="cpp">array&lt;</span></span>Single<span class="languageSpecificText"><span class="cpp">&gt;</span><span class="cs">[]</span><span class="vb">()</span><span class="nu">[]</span></span>, MCvTermCriteria, LKFLOW_TYPE)</span></span><span id="languageFilter"><select id="languageSelector" onchange="var names = this.value.split(' '); toggleVisibleLanguage(names[1]); lfc.switchLanguage(names[0]); store.set('lang',this.value); store.save();"><option value="CSharp cs">C#</option><option value="VisualBasic vb">Visual Basic</option><option value="ManagedCPlusPlus cpp">Visual C++</option></select></span></div></div><div id="main"><script type="text/javascript"><!--
google_ad_client = "pub-0111567351193216";
/* 728x90, created 8/14/08 */
google_ad_slot = "3483381042";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></p><span style="color: DarkGray">www.emgu.com/wiki </span><div class="summary">
            Implements sparse iterative version of Lucas-Kanade optical flow in pyramids ([Bouguet00]). It calculates coordinates of the feature points on the current video frame given their coordinates on the previous frame. The function finds the coordinates with sub-pixel accuracy. 
            </div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img src="../icons/collapse_all.gif" /> Declaration Syntax</div><div class="sectionContent"><div id="syntaxSection"><table class="filter"><tr class="tabs" id="syntaxTabs"><td class="tab" x-lang="CSharp" onclick="toggleClass('syntaxTabs','x-lang','CSharp','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','CSharp','display','block','none');">C#</td><td class="tab" x-lang="VisualBasic" onclick="toggleClass('syntaxTabs','x-lang','VisualBasic','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','VisualBasic','display','block','none');">Visual Basic</td><td class="tab" x-lang="ManagedCPlusPlus" onclick="toggleClass('syntaxTabs','x-lang','ManagedCPlusPlus','activeTab','tab'); toggleStyle('syntaxBlocks','x-lang','ManagedCPlusPlus','display','block','none');">Visual C++</td></tr></table><div id="syntaxBlocks"><div class="code" x-lang="CSharp"><pre><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">cvCalcOpticalFlowPyrLK</span>(
	<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a> <span class="parameter">prev</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a> <span class="parameter">curr</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a> <span class="parameter">prevPyr</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a> <span class="parameter">currPyr</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">float</a>[,] <span class="parameter">prevFeatures</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">float</a>[,] <span class="parameter">currFeatures</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">count</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/bfwt6fe5" target="_blank">Size</a> <span class="parameter">winSize</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">level</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/yyb1w04y" target="_blank">byte</a>[] <span class="parameter">status</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">float</a>[] <span class="parameter">trackError</span>,
	<a href="e6a9a61a-590b-2e7d-b9f5-32e89340291a.htm">MCvTermCriteria</a> <span class="parameter">criteria</span>,
	<a href="de3e445e-1b31-4870-c4fb-9bc4056066b8.htm">LKFLOW_TYPE</a> <span class="parameter">flags</span>
)</pre></div><div class="code" x-lang="VisualBasic"><pre><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Sub</span> <span class="identifier">cvCalcOpticalFlowPyrLK</span> ( _
	<span class="parameter">prev</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a>, _
	<span class="parameter">curr</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a>, _
	<span class="parameter">prevPyr</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a>, _
	<span class="parameter">currPyr</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a>, _
	<span class="parameter">prevFeatures</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">Single</a>(,), _
	<span class="parameter">currFeatures</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">Single</a>(,), _
	<span class="parameter">count</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Integer</a>, _
	<span class="parameter">winSize</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/bfwt6fe5" target="_blank">Size</a>, _
	<span class="parameter">level</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Integer</a>, _
	<span class="parameter">status</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/yyb1w04y" target="_blank">Byte</a>(), _
	<span class="parameter">trackError</span> <span class="keyword">As</span> <a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">Single</a>(), _
	<span class="parameter">criteria</span> <span class="keyword">As</span> <a href="e6a9a61a-590b-2e7d-b9f5-32e89340291a.htm">MCvTermCriteria</a>, _
	<span class="parameter">flags</span> <span class="keyword">As</span> <a href="de3e445e-1b31-4870-c4fb-9bc4056066b8.htm">LKFLOW_TYPE</a> _
)</pre></div><div class="code" x-lang="ManagedCPlusPlus"><pre><span class="keyword">public</span>:
<span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">cvCalcOpticalFlowPyrLK</span>(
	<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a> <span class="parameter">prev</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a> <span class="parameter">curr</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a> <span class="parameter">prevPyr</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a> <span class="parameter">currPyr</span>, 
	<span class="keyword">array</span>&lt;<a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">float</a>,2&gt;^ <span class="parameter">prevFeatures</span>, 
	<span class="keyword">array</span>&lt;<a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">float</a>,2&gt;^ <span class="parameter">currFeatures</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">count</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/bfwt6fe5" target="_blank">Size</a> <span class="parameter">winSize</span>, 
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">level</span>, 
	<span class="keyword">array</span>&lt;<a href="http://msdn2.microsoft.com/en-us/library/yyb1w04y" target="_blank">unsigned char</a>&gt;^ <span class="parameter">status</span>, 
	<span class="keyword">array</span>&lt;<a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">float</a>&gt;^ <span class="parameter">trackError</span>, 
	<a href="e6a9a61a-590b-2e7d-b9f5-32e89340291a.htm">MCvTermCriteria</a> <span class="parameter">criteria</span>, 
	<a href="de3e445e-1b31-4870-c4fb-9bc4056066b8.htm">LKFLOW_TYPE</a> <span class="parameter">flags</span>
)</pre></div></div></div></div></div><div id="parameters"><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img src="../icons/collapse_all.gif" /> Parameters</div><div class="sectionContent"><dl paramName="prev"><dt><span class="parameter">prev</span> (<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a>)</dt><dd>First frame, at time t. </dd></dl><dl paramName="curr"><dt><span class="parameter">curr</span> (<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a>)</dt><dd>Second frame, at time t + dt .</dd></dl><dl paramName="prevPyr"><dt><span class="parameter">prevPyr</span> (<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a>)</dt><dd>Buffer for the pyramid for the first frame. If the pointer is not NULL , the buffer must have a sufficient size to store the pyramid from level 1 to level #level ; the total size of (image_width+8)*image_height/3 bytes is sufficient. </dd></dl><dl paramName="currPyr"><dt><span class="parameter">currPyr</span> (<a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a>)</dt><dd>Similar to prev_pyr, used for the second frame. </dd></dl><dl paramName="prevFeatures"><dt><span class="parameter">prevFeatures</span> (<span class="languageSpecificText"><span class="cpp">array&lt;</span></span>
            <a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">Single</a>
          <span class="languageSpecificText"><span class="cpp">,2&gt;</span><span class="cs">[,]</span><span class="vb">(,)</span><span class="nu">[,]</span></span>)</dt><dd>Array of points for which the flow needs to be found. </dd></dl><dl paramName="currFeatures"><dt><span class="parameter">currFeatures</span> (<span class="languageSpecificText"><span class="cpp">array&lt;</span></span>
            <a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">Single</a>
          <span class="languageSpecificText"><span class="cpp">,2&gt;</span><span class="cs">[,]</span><span class="vb">(,)</span><span class="nu">[,]</span></span>)</dt><dd>Array of 2D points containing calculated new positions of input </dd></dl><dl paramName="count"><dt><span class="parameter">count</span> (<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Int32</a>)</dt><dd>Number of feature points.</dd></dl><dl paramName="winSize"><dt><span class="parameter">winSize</span> (<a href="http://msdn2.microsoft.com/en-us/library/bfwt6fe5" target="_blank">Size</a>)</dt><dd>Size of the search window of each pyramid level.</dd></dl><dl paramName="level"><dt><span class="parameter">level</span> (<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Int32</a>)</dt><dd>Maximal pyramid level number. If 0 , pyramids are not used (single level), if 1 , two levels are used, etc. </dd></dl><dl paramName="status"><dt><span class="parameter">status</span> (<span class="languageSpecificText"><span class="cpp">array&lt;</span></span>
            <a href="http://msdn2.microsoft.com/en-us/library/yyb1w04y" target="_blank">Byte</a>
          <span class="languageSpecificText"><span class="cpp">&gt;</span><span class="cs">[]</span><span class="vb">()</span><span class="nu">[]</span></span>)</dt><dd>Array. Every element of the array is set to 1 if the flow for the corresponding feature has been found, 0 otherwise.</dd></dl><dl paramName="trackError"><dt><span class="parameter">trackError</span> (<span class="languageSpecificText"><span class="cpp">array&lt;</span></span>
            <a href="http://msdn2.microsoft.com/en-us/library/3www918f" target="_blank">Single</a>
          <span class="languageSpecificText"><span class="cpp">&gt;</span><span class="cs">[]</span><span class="vb">()</span><span class="nu">[]</span></span>)</dt><dd>Array of double numbers containing difference between patches around the original and moved points. Optional parameter; can be NULL </dd></dl><dl paramName="criteria"><dt><span class="parameter">criteria</span> (<a href="e6a9a61a-590b-2e7d-b9f5-32e89340291a.htm">MCvTermCriteria</a>)</dt><dd>Specifies when the iteration process of finding the flow for each point on each pyramid level should be stopped.</dd></dl><dl paramName="flags"><dt><span class="parameter">flags</span> (<a href="de3e445e-1b31-4870-c4fb-9bc4056066b8.htm">LKFLOW_TYPE</a>)</dt><dd>Miscellaneous flags</dd></dl></div></div></div><div class="section"><div class="sectionTitle" onclick="toggleSection(this.parentNode)"><img src="../icons/collapse_all.gif" /> Remarks</div><div class="sectionContent">Both parameters prev_pyr and curr_pyr comply with the following rules: if the image pointer is 0, the function allocates the buffer internally, calculates the pyramid, and releases the buffer after processing. Otherwise, the function calculates the pyramid and stores it in the buffer unless the flag CV_LKFLOW_PYR_A[B]_READY is set. The image should be large enough to fit the Gaussian pyramid data. After the function call both pyramids are calculated and the readiness flag for the corresponding image can be set in the next call (i.e., typically, for all the image pairs except the very first one CV_LKFLOW_PYR_A_READY is set). </div></div><p><div id="footer">For questions and discussions please visit www.emgu.com/forum<p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:emgucv%40gmail.com?Subject=Emgu CV Library Documentation">emgucv@gmail.com</a>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script> <p />2008 Emgu, All Rights Reserved,</div>Assembly: <span sdata="assembly">Emgu.CV</span> (Module: Emgu.CV) Version: 1.5.0.0 (1.5.0.0)</p></div></body></html>